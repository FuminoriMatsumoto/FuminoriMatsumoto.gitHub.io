---
import { fmtTime, getDescription } from "@/utils/index";
import getCover from "@/utils/getCover";

const { post } = Astro.props;
// 获取文章的摘要
const description = getDescription(post);
// 获取封面图
const ARTICLE_COVER: string = await getCover(post.data.cover);

// 引入样式
import "./ArticleCard.less";
---

<article class={`vh-article-item vh-animation vh-animation-init vh-article-link${post.data.top ? " active" : ""}`}>
  <!-- 封面图 -->
  <section class="vh-article-banner">
    <img
      src="/assets/images/lazy-loading.webp"
      data-vh-lz-src={ARTICLE_COVER}
      alt={post.data.title}
    />
  </section>

  <!-- 文章头部 -->
  <header>
    <h3>
      <a
        class={`vh-article-cat vh-cat-${post.data.categories}`}
        href={`/categories/${post.data.categories}`}
      >
        {post.data.categories}
      </a>
      <time>{fmtTime(post.data.date)}</time>
    </h3>
    <h1 class="title">
      <a class="vh-ellipsis" href={`/article/${post.data.id}`}>
        {post.data.title}
      </a>
    </h1>
  </header>

  <!-- 摘要 -->
  <h2 class="vh-article-excerpt vh-ellipsis line-2">
    {description}
  </h2>

  <!-- 标签 -->
  <h4 class="vh-article-taglist vh-ellipsis">
    {post.data.tags.map((tag: string) => (
      <a href={`/tag/${tag}`}>{tag}</a>
    ))}
  </h4>
</article>
